function [y1] = autoencoder0502Fcnv3(x1)
%AUTOENCODER0502FCNV3 neural network simulation function.
%
% Auto-generated by MATLAB, 03-May-2021 07:51:48.
% 
% [y1] = autoencoder0502Fcnv3(x1) takes these arguments:
%   x = 21xQ matrix, input #1
% and returns:
%   y = 2xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1.76739082865433;-1.02603597416133;-1.46139665303231;-3.76708315931194;-2.43803113384524;-2.42597912896625;-2.31199088818679;-2.47427248753637;-1.31261433133653;-1.63890190052334;-2.12195538458431;-2.14517561225309;-2.90778018127142;-2.24776075832193;-1.96731066812182;-3.15585589003053;-2.72664097905474;-2.26419458916904;-2.50572538551881;-1.6468524274974;-0.801376450496509];
x1_step1.gain = [0.555942976728115;0.980331075631443;0.570656311652412;0.233351103130038;0.408049105743721;0.395896290122211;0.401878752620574;0.390610193592537;0.378875551390832;0.243686462853041;0.41128356692561;0.397539170238273;0.353064539622557;0.458557820114054;0.375531699762838;0.354789478985157;0.387153914518255;0.415860363570736;0.388318891694985;0.425560107592097;0.347480985215508];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.4731695457306377417;-1.7322121530449243743;1.2735474058527067598;-1.1596621226210306332;0.78372559852062639862;0.81119868801207595244;0.64227120282912186777;0.20874760699092262395;0.35742799493572907643;-0.18073678040508095455;-0.15745191717588560842;0.24860250931384342277;-0.32968938594870639269;0.67088831012903571427;-0.81024639816473909004;-1.1062774571807036939;-1.1323011612937885495;-1.2461449654703578016;-1.4594835730650923544;-2.1239377671013506266];
IW1_1 = [-0.37357791140088053572 -0.42163560993489412887 -0.12440632134589330038 0.30238120872085089141 -0.85097051051713856751 0.84436496886571588139 0.17510846830998261225 -0.34254519089230694995 0.80065415428702202405 0.018544934095184175543 0.15324581885861005004 -0.50584916523410206057 0.49477949608853455388 -0.21829792437916473169 0.49281384288451390852 0.2948507942165754514 -0.40530414766522665504 -0.15993374917569913585 -0.48509047996885645837 0.082068534437299694995 -0.11219899965627465332;0.94098467180047606906 0.24150337119591719359 0.28168079400276135882 -0.28107186598804845268 -0.50955198755495678675 -0.16753004395998738474 -0.67898295111853657069 -0.20523039045991164908 -0.23627531291410081016 0.16759883011224552263 0.10049172800969860542 -0.34345367648455071841 0.23726674971509195688 0.57744994162908647173 -0.030413770742673984504 0.041943337640483552287 0.11882547907327392633 0.55793205917966082197 -0.23613365837277500159 0.27532002644098430011 -0.07520135926631464629;-0.019109369712139660791 -0.26315638478849867621 0.5354001432673199945 -0.21334152998895719588 -0.19936395004956894428 0.14666076196490596129 0.60719114135905616347 0.55023266461222075652 -0.1932438893829255544 -0.56189743798553248855 0.57790902338600502741 -0.20487055593146441534 -0.30575993834489967327 0.2167608649826669176 -0.18134446999302802905 0.2757647746403562028 -0.34930597563658655202 0.41408797961986631986 0.14397846439268000007 0.38725631783004188513 -0.014517455304454168763;0.34535783731835195676 0.046495142610036302444 0.31086333728520210151 0.32605394559285960643 -0.16558349125644561406 0.089335529723831186288 0.46699534142463083874 0.15202585832837883784 -0.22513472319737101723 -0.23898869006709344553 -0.075932146455162372045 -0.27540248812096113085 -0.42087833924070827685 -0.2178403670629956157 0.39976633985923659687 -0.55137733048203996233 -0.64665117660175286396 0.48608373366499962875 -0.38737948784914272293 0.68154891062482958475 -0.46683019561058947122;-0.023407021811639387721 -0.22658623646923217732 0.7852690960623688321 -0.13744004874707582697 0.93297218330230535788 -0.69042955474685729911 0.067532212149543580093 -0.14271741382052671732 -0.33870209951308849483 -0.37251689872323368036 -0.10040356122333060629 -0.4518154875593521913 -0.35350749270259201884 0.052188282450526854439 0.21274004520283867903 0.6573845493799485018 -0.27829714433611874025 0.29864998555987820605 -0.051744371032049145398 0.33235671661063725946 -0.69116320279836274132;-0.52858537078286116362 -0.436753871993951992 -0.55373905271764634062 0.18966326119606535805 -0.13074155931885023119 0.21493171075519648672 0.29340851370164650058 0.17920061250434657363 0.16222305035112433158 -0.3211383409328775751 -0.46587132002609338288 0.16338061468779929708 0.5485470281032678308 0.085408459031696720709 -0.2014377213448252657 -0.16341491447433498241 0.36752985318244579815 -0.29671153117789106357 -0.58550587134788945054 -0.43064901068382765992 -0.28349120571431318805;-0.058224592674035097195 -0.29290371547500104743 -0.33719927415464906462 -0.41673588738184585978 0.68673091873756697545 -0.43421735541300521266 -0.10370459288544384147 -0.17597479148888431344 -0.12490617211186569313 0.1829938960657055691 0.1998561622431918039 0.47899580740092490005 0.22361974233268921974 -0.32055489524134267443 -0.34753654290171159813 0.46993885226123055521 0.45677636779205477158 0.25512137448936988982 0.28651670284146757428 0.19815119627257257728 0.48613234278803590938;-0.9923004870759053464 0.021221770408470778946 -0.31563910392185545728 0.043081949531336087567 -0.52784017340032751697 0.01642666504784520351 -0.21792827345804927086 -0.062453080735205356022 0.046828806281974007242 0.70082710182661267506 -0.16082142320509765221 -0.27732244731083621758 0.48381448019996309284 0.71285589297824658583 0.45886767536079980934 0.36544362314239547951 0.64108951503768552005 -0.5133408577092911651 0.28333938921424350887 -0.57944829372824591118 0.73798428522404679875;-0.38462691075334676238 0.37431511834960051743 0.51988800465668649764 0.34947309235821966134 0.31640213294947483469 0.52867511287843083068 -0.56509900069150886814 0.54016907984175388524 0.25026416418952074361 -0.051818057884118161327 0.32947201775528800471 -0.010515582990255858964 -0.31361992881318428994 0.552814817008423387 -0.32735689557106673053 0.085370192022161561773 0.048885901971556594559 0.22293892698023967669 -0.10743991066544650304 0.022211393181178429312 -0.52184785388133436701;0.13682063316514253559 0.25827927580909559868 0.065229107244279355138 0.23141813579667760981 -0.48335444098181629125 0.43380899324116151128 -0.071896709748704226706 0.31985162447003506747 0.26373061179337387028 0.58187685931316746046 -0.56182836251408607708 0.087937672001651936982 0.26873501511741726411 0.50089002786643010978 -0.31483575301230104504 -0.24378276581429822456 -0.42823452018136276553 0.22873336395364210483 -0.49334429484313491177 -0.27043452029884973431 0.25163110988565784432;-0.083552580813914673064 0.54575682330321051428 0.23205717852901716625 0.37741793410882235049 0.047772056202489456 -0.75709509497502536224 0.27707181528788832336 0.63718383684976098724 0.3673414032284582631 0.43139238548248193261 0.17305484078101493473 0.23065056563522659538 0.111567654625767676 -0.093831341535552614808 -0.24416707365412013142 -0.34220069786053153305 0.30555212067228942896 0.12956819510737946355 -0.59270537082872321033 0.056568307544644223783 0.0060906857146742262449;0.31720032637296535771 -0.21679225794260226223 -0.32873847225370800285 -0.048597096706078292405 -0.090595092358007611733 -0.013026777148045233859 0.16106932364832457494 0.18230939264496931473 0.45100338152776042744 0.50320637476058760473 0.53434862261071314204 -0.14960310207350110967 -0.45838788173327976727 0.3111098998486162559 -0.34499028206900833604 -0.56046831197139712621 0.34002578924796639237 0.23171113024330722285 0.51655988798064722545 0.1813246350797717843 -0.31202840267837061994;-0.040776844980651510975 -0.04659330393020093275 0.11798603674493540749 -0.33239263950000846881 -0.24568577884881867557 0.62668833514951594044 0.46813895718107145782 -0.53824877387272185292 0.39653915772078984769 0.1036685510150305578 0.041839591287159985655 0.57063660364983259665 0.085037104560521298291 0.87720520881169306016 0.54042180609871481867 -0.42253572547368034584 0.0086152872549085622589 0.21547270362959153323 -0.081511158310920220349 0.066645311781683244656 0.26305006395011643061;1.059757295072377703 0.075272836254556108049 -0.28934141610599550809 0.35828867524046925652 -0.36539700004864628102 -0.17093898939394147618 -0.72327078517794873846 -0.2949353509855988098 -0.31422678702313167065 -0.12856075311165998665 -0.45958827293311860229 0.39865918620222640101 -0.0016648555078428717291 -0.21665174633995806786 -0.060598899704392666932 -0.080953969239939083113 -0.43363738275223895346 0.25711386672610309079 -0.45052251236551782432 -0.41097302982635680602 -0.27415796016868682061;-0.67812492026731918671 -0.034395282094458169697 0.1566707922448321022 -0.18369359205201607477 0.21907840672241368773 0.42002981635400521432 0.69855152602151093788 -0.45548105963034352106 0.025817440996946813825 0.50039082264338652362 0.42263961373968289559 -0.33214568160794005758 -0.024712080848987016957 -0.11866588135743247334 -0.3836667691261965718 0.50487083931909981782 -0.11148094787904273828 0.018787080864575592815 0.2746183651632723155 -0.14137599378872492406 0.82344120283525257253;-0.39905025944506650193 0.14209924699052894903 -0.37785575824047934468 -0.5171382621215983022 -0.084649207069210197218 -0.29890400938438665968 -0.24061185909874407973 0.42901351709823326575 0.30585113343466058256 0.39115543147045739314 -0.4799503411867012681 -0.079396382890787486897 0.10566319356002908114 0.47448726246486766511 0.032696344245071590207 -0.2266593082807922821 0.46037968058268552429 -0.20665202368045790249 -0.28352908423991096676 0.25633760931614435474 0.015761820586042408349;0.07466368603225428946 0.23621936371723586956 -0.48220976568667145434 -0.28745343838068260212 0.3267250705738362071 -0.39201480759761131445 0.72299159162803905421 -0.11553283445661272077 -0.16460876014281597413 0.1446416601928691148 -0.79633638823865648959 -0.6471451044006211184 0.13004784627751947435 0.243106623182661713 0.1492098826289230129 0.48746601907054015745 0.58711885833219157327 -0.13877025993648198221 -0.24754242942170903707 0.20652977108006070894 0.090284313308226823991;-0.13901338121247602819 -0.61814282432929701372 0.25177024982568035893 0.080947763685211837625 -0.33178307151822622467 0.44328964796972486484 -0.25099878887830684437 0.61584378478041801319 -0.46694801231146226828 0.40564585042208101129 -0.45156641124885332772 -0.35849036847349896595 -0.0070637197086230868459 0.24517053608433622691 -0.34878604371811577911 -0.27260958159237069776 0.4278880752800332532 -0.24822611590250012736 0.1140987184348911665 -0.406237626909792926 -0.21119185126709041911;-0.52306077882017909531 -0.018555736904159708667 0.4373851016740646358 0.30133824737906966806 0.49849650337237616515 -0.37846549658735079147 -0.43458515117515006398 0.47373617855186167525 -0.33560036566603662633 -0.40654992576940496285 0.16289774505778839564 -0.37430804819678231699 -0.24030754541726759288 0.20118859969374966457 0.22777455030236656852 -0.3221984889981097111 0.47476378797492468919 0.21087000844337516758 -0.16259257861935721978 0.15805999707809920141 0.48908036432668011706;-0.11655847663621100863 0.9462588321866657326 -0.68847301617916045746 0.20143283542518622409 -0.062281698243778813029 0.035773615799899592671 -0.12562466358779600384 0.18371806162617598801 0.076188591657305876348 -0.12013152558077341836 0.021817772642417986029 0.21599067193148346888 -0.51620087883627019387 0.74204609305431068478 0.48653415058203414167 -0.65193316333288975351 0.32901515078001131176 -0.19887525250414916922 -0.15655677206341248042 -0.46546006658574695658 -0.65925327666755251244];

% Layer 2
b2 = [-0.43145944481965886608;-0.65622906068856867723];
LW2_1 = [-0.49827749839407897703 -0.72747008704005100554 -0.49326051550245947341 -0.04919797665683466048 -0.42227484631449602182 0.35247996987036489536 0.22714382109065070492 0.55536365046058555617 0.75192835767057830676 0.54573981543140237527 -0.060002271745192369001 -0.46340060313596470598 -0.054302928699094629716 0.67525094988883627156 -0.63778211600896972389 0.18545043400985519733 0.37802935671015797103 -0.63155205054017593547 0.23448929261713180594 -0.8892102442950019503;0.42479732326500929673 0.36874601513468968639 -0.51292990953577577429 -0.75172843930394961376 0.96896060546825868443 0.72086959515446091817 0.58330327173804796814 -0.34565670561166750296 0.38747168342244159289 0.76816187021694837256 -0.3801390511185852028 -0.73810297044627626306 -0.82864545975468306693 -0.44189216255462471228 0.16916961791609910759 0.085808632961294872832 -0.14951692861253521039 -0.19814544696907662735 -0.062052831089600898884 0.92223652430276348291];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);

% Output 1
y1 = a2;
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
  if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
  else
    a = iSoftmaxApplyCPU(n);
  end
end
function a = iSoftmaxApplyCPU(n)
  nmax = max(n,[],1);
  n = bsxfun(@minus,n,nmax);
  numerator = exp(n);
  denominator = sum(numerator,1); 
  denominator(denominator == 0) = 1;
  a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
  nmax = max(n,[],1);
  numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
  denominator = sum(numerator,1);
  a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
  numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
  if (denominator == 0)
    a = numerator;
  else
    a = numerator ./ denominator;
  end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
